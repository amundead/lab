worker_processes 1;

events {
    worker_connections 1024;
}

http {
    server {
        listen 80;
        server_name localhost;

        # Enable CORS for the /host-info endpoint
        add_header 'Access-Control-Allow-Origin' '*';
        add_header 'Access-Control-Allow-Methods' 'GET, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'Content-Type';

        # Serve the static content (index.html)
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }

        # Serve the host info using the background service running at port 8080
        location /host-info {
            default_type application/json;
            proxy_pass http://127.0.0.1:8080;  # Forward to the script output on port 8080
            # Optionally add CORS headers for this endpoint as well
            add_header 'Access-Control-Allow-Origin' '*';
        }
    }
}
